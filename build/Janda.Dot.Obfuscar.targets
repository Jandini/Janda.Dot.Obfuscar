<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup Condition=" $(Configuration) == Release ">     
    <CopyLocalLockFileAssemblies>true</CopyLocalLockFileAssemblies> 
    <MessageHeader>Janda.Dot.Obfuscar -> </MessageHeader>
  </PropertyGroup>

  <Target Condition=" $(Configuration)==Release " Name="Obfuscate" AfterTargets="Build" >
    <PropertyGroup>
      <ObfuscateDir>$(OutputPath)obfuscate\$(ProjectName)</ObfuscateDir>
      <ObfuscatedFile>$(ObfuscateDir)\$(TargetFileName)</ObfuscatedFile>
    </PropertyGroup>

    <Message Text="$(MessageHeader)Running &quot;$(Obfuscar)&quot; -s $(ProjectDir)obfuscar.xml" Importance="high" />
    <Exec WorkingDirectory="$(OutputPath)" Command="&quot;$(Obfuscar)&quot; -s $(ProjectDir)obfuscar.xml" ContinueOnError="false" />

    <Message Text="$(MessageHeader)Backing up $(TargetPath)" Importance="high" />
    <Move SourceFiles="$(TargetPath)" DestinationFiles="$(TargetPath).bak" />

    <Message Text="$(MessageHeader)Copying $(ObfuscatedFile) to $(OutputPath)" Importance="high" />
    <Copy SourceFiles="$(ObfuscatedFile)" DestinationFolder="$(OutputPath)" />

    <Message Text="$(MessageHeader)$(ProjectName) obfuscation complete." Importance="high" />
  </Target>
</Project>